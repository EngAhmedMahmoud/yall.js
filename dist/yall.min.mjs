export default function(e){var t=(e=e||{}).lazyClass||"lazy",o=e.lazyBackgroundClass||"lazy-bg",r="idleLoadTimeout"in e?e.idleLoadTimeout:200,a=e.observeChanges||!1,n=e.events||{},i=e.noPolyfill||!1,s=window,l="requestIdleCallback",d="IntersectionObserver",c=["srcset","src","poster"],u=[],v=(e,r)=>u.slice.call((r||document).querySelectorAll(e||"img."+t+",video."+t+",iframe."+t+",."+o)),b=t=>{var r=t.parentNode;"PICTURE"==r.nodeName&&m(v("source",r),f),"VIDEO"==t.nodeName&&m(v("source",t),f),f(t),t.autoplay&&t.load();var a=t.classList;a.contains(o)&&(a.remove(o),a.add(e.lazyBackgroundLoaded||"lazy-bg-loaded"))},g=e=>{for(var t in n)e.addEventListener(t,n[t].listener||n[t],n[t].options||void 0)},f=e=>{var t=function(t){c[t]in e.dataset&&s.requestAnimationFrame(()=>{e.setAttribute(c[t],e.dataset[c[t]])})};for(var o in c)t(o)},m=(e,t)=>{for(var o=0;o<e.length;o++)t instanceof s[d]?t.observe(e[o]):t(e[o])},y=e=>{if(e.isIntersecting||e.intersectionRatio){var o=e.target;l in s&&r?s[l](()=>{b(o)},{timeout:r}):b(o),o.classList.remove(t),L.unobserve(o),(p=p.filter(e=>e!=o)).length||a||L.disconnect()}},h=e=>{p.indexOf(e)<0&&(p.push(e),g(e),L.observe(e))},p=v();if(/baidu|(?:google|bing|yandex|duckduck)bot/i.test(navigator.userAgent))m(p,b);else if(d in s&&d+"Entry"in s){var L=new s[d](e=>{m(e,y)},{rootMargin:("threshold"in e?e.threshold:200)+"px 0%"});m(p,g),m(p,L),a&&m(v(e.observeRootSelector||"body"),t=>{new MutationObserver(()=>{m(v(),h)}).observe(t,e.mutationObserverOptions||{childList:!0,subtree:!0})})}else i&&(m(p,g),m(p,b))}
